var https = require('https');

var ClearbitReveal = {
  find: function(params) {
    https.get({
      host: 'reveal.clearbit.com',
      path: '/v1/companies/find?ip=' + params.ip,
      headers: {
        'Authorization': ('Bearer ' + params.apiKey)
      }

    }).on('response', (response) => {
      var chunks = [];

      response
        .on('data', (chunk) => {
          chunks.push(chunk);
        }).on('end', function() {
          var buffer = Buffer.concat(chunks);
          var object = JSON.parse(buffer.toString('utf-8'));

          params.done && params.done(object);
        });

    }).on('error', (e) => {
      params.error && params.error(e);
    });
  }
}

var ip = '104.193.168.24';

ClearbitReveal.find({
  ip: ip,
  apiKey: process.env.CLEARBIT_KEY,

  done: function(company) {
    console.log(company)
  }
});
